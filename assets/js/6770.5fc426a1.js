"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[6770,9068],{69068(t,e,i){i.r(e),i.d(e,{VideoProvider:()=>p});var s=i(94487),n=i(89225),r=i(58554),o=i(88508),a=i(85802);class c{#t;#e;constructor(t,e){this.#t=t,this.#e=e,t.textTracks.onaddtrack=this.#i.bind(this),(0,s.zp)(this.#s.bind(this))}#i(t){const e=t.track;if(!e||function(t,e){return Array.from(t.children).find(t=>t.track===e)}(this.#t,e))return;const i=new a.to({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});i[a.Hp.native]={track:e},i[a.Hp.readyState]=2,i[a.Hp.nativeHLS]=!0;let s=0;const n=t=>{if(e.cues)for(let n=s;n<e.cues.length;n++)i.addCue(e.cues[n],t),s++};n(t),e.oncuechange=n,this.#e.textTracks.add(i,t),i.setMode(e.mode,t)}#s(){this.#t.textTracks.onaddtrack=null;for(const t of this.#e.textTracks){const e=t[a.Hp.native]?.track;e?.oncuechange&&(e.oncuechange=null)}}}class h{#t;#n;constructor(t,e){this.#t=t,this.#n=e,new s.En(t).add("enterpictureinpicture",this.#r.bind(this)).add("leavepictureinpicture",this.#o.bind(this))}get active(){return document.pictureInPictureElement===this.#t}get supported(){return(0,n.dE)(this.#t)}async enter(){return this.#t.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}#r(t){this.#a(!0,t)}#o(t){this.#a(!1,t)}#a=(t,e)=>{this.#n.notify("picture-in-picture-change",t,e)}}class d{#t;#n;#c="inline";get mode(){return this.#c}constructor(t,e){this.#t=t,this.#n=e,(0,s.k6)(t,"webkitpresentationmodechanged",this.#h.bind(this))}get supported(){return(0,n.Jt)(this.#t)}async setPresentationMode(t){this.#c!==t&&this.#t.webkitSetPresentationMode(t)}#h(t){const e=this.#c;this.#c=this.#t.webkitPresentationMode,this.#n.player?.dispatch(new s.vP("video-presentation-change",{detail:this.#c,trigger:t})),["fullscreen","picture-in-picture"].forEach(i=>{this.#c!==i&&e!==i||this.#n.notify(`${i}-change`,this.#c===i,t)})}}class l{#d;get active(){return"fullscreen"===this.#d.mode}get supported(){return this.#d.supported}constructor(t){this.#d=t}async enter(){this.#d.setPresentationMode("fullscreen")}async exit(){this.#d.setPresentationMode("inline")}}class u{#d;get active(){return"picture-in-picture"===this.#d.mode}get supported(){return this.#d.supported}constructor(t){this.#d=t}async enter(){this.#d.setPresentationMode("picture-in-picture")}async exit(){this.#d.setPresentationMode("inline")}}class p extends r.B{$$PROVIDER_TYPE="VIDEO";get type(){return"video"}airPlay;fullscreen;pictureInPicture;constructor(t,e){super(t,e),(0,s.P1)(()=>{if(this.airPlay=new o.z(t,e),(0,n.Jt)(t)){const i=new d(t,e);this.fullscreen=new l(i),this.pictureInPicture=new u(i)}else(0,n.dE)(t)&&(this.pictureInPicture=new h(t,e))},this.scope)}setup(){super.setup(),(0,n.uo)(this.video)&&new c(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),(0,s.zp)(()=>{this.ctx.textRenderers.attachVideo(null)}),"video"===this.type&&this.ctx.notify("provider-setup",this)}get video(){return this.media}}},86770(t,e,i){i.r(e),i.d(e,{HLSProvider:()=>v});var s=i(73362),n=i(89225),r=i(69068),o=i(94487),a=i(35599),c=i(85802),h=i(3187),d=i(50490),l=i(59107);class u{#t;#e;#l=null;#u=null;config={};#p=new Set;get instance(){return this.#l}constructor(t,e){this.#t=t,this.#e=e}setup(t){const{streamType:e}=this.#e.$state,i=(0,o.se)(e).includes("live"),s=(0,o.se)(e).includes("ll-");this.#l=new t({lowLatencyMode:s,backBufferLength:s?4:i?8:void 0,renderTextTracksNatively:!1,...this.config});const n=this.#v.bind(this);for(const e of Object.values(t.Events))this.#l.on(e,n);this.#l.on(t.Events.ERROR,this.#g.bind(this));for(const t of this.#p)t(this.#l);this.#e.player.dispatch("hls-instance",{detail:this.#l}),this.#l.attachMedia(this.#t),this.#l.on(t.Events.AUDIO_TRACK_SWITCHED,this.#y.bind(this)),this.#l.on(t.Events.LEVEL_SWITCHED,this.#b.bind(this)),this.#l.on(t.Events.LEVEL_LOADED,this.#x.bind(this)),this.#l.on(t.Events.LEVEL_UPDATED,this.#f.bind(this)),this.#l.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.#E.bind(this)),this.#l.on(t.Events.CUES_PARSED,this.#k.bind(this)),this.#e.qualities[a.k.enableAuto]=this.#m.bind(this),(0,o.k6)(this.#e.qualities,"change",this.#L.bind(this)),(0,o.k6)(this.#e.audioTracks,"change",this.#S.bind(this)),this.#u=(0,o.QZ)(this.#w.bind(this))}#P(t,e){return new o.vP((t=>(0,o.BW)(t))(t),{detail:e})}#w(){if(!this.#e.$state.live())return;const t=new d.e(this.#T.bind(this));return t.start(),t.stop.bind(t)}#T(){this.#e.$state.liveSyncPosition.set(this.#l?.liveSyncPosition??1/0)}#v(t,e){this.#e.player?.dispatch(this.#P(t,e))}#E(t,e){const i=this.#P(t,e);let s=-1;for(let t=0;t<e.tracks.length;t++){const n=e.tracks[t],r=n.subtitleTrack??n.closedCaptions,o=new c.to({id:`hls-${n.kind}-${t}`,src:r?.url,label:n.label,language:r?.lang,kind:n.kind,default:n.default});o[c.Hp.readyState]=2,o[c.Hp.onModeChange]=()=>{"showing"===o.mode?(this.#l.subtitleTrack=t,s=t):s===t&&(this.#l.subtitleTrack=-1,s=-1)},this.#e.textTracks.add(o,i)}}#k(t,e){const i=this.#l?.subtitleTrack,s=this.#e.textTracks.getById(`hls-${e.type}-${i}`);if(!s)return;const n=this.#P(t,e);for(const t of e.cues)t.positionAlign="auto",s.addCue(t,n)}#y(t,e){const i=this.#e.audioTracks[e.id];if(i){const s=this.#P(t,e);this.#e.audioTracks[h.j.select](i,!0,s)}}#b(t,e){const i=this.#e.qualities[e.level];if(i){const s=this.#P(t,e);this.#e.qualities[h.j.select](i,!0,s)}}#f(t,e){e.details.totalduration>0&&this.#e.$state.inferredLiveDVRWindow.set(e.details.totalduration)}#x(t,e){if(this.#e.$state.canPlay())return;const{type:i,live:s,totalduration:n,targetduration:r}=e.details,c=this.#P(t,e);this.#e.notify("stream-type-change",s?"EVENT"===i&&Number.isFinite(n)&&r>=10?"live:dvr":"live":"on-demand",c),this.#e.notify("duration-change",n,c);const d=this.#l.media;-1===this.#l.currentLevel&&this.#e.qualities[a.k.setAuto](!0,c);for(const t of this.#l.audioTracks){const e={id:t.id.toString(),label:t.name,language:t.lang||"",kind:"main"};this.#e.audioTracks[h.j.add](e,c)}for(const t of this.#l.levels){const e={id:t.id?.toString()??t.height+"p",width:t.width,height:t.height,codec:t.codecSet,bitrate:t.bitrate};this.#e.qualities[h.j.add](e,c)}d.dispatchEvent(new o.vP("canplay",{trigger:c}))}#g(t,e){e.fatal&&("mediaError"===e.type?this.#l?.recoverMediaError():this.#C(e.error))}#C(t){this.#e.notify("error",{message:t.message,code:1,error:t})}#m(){this.#l&&(this.#l.currentLevel=-1)}#L(){const{qualities:t}=this.#e;this.#l&&!t.auto&&(this.#l[t.switch+"Level"]=t.selectedIndex,n.G_&&(this.#t.currentTime=this.#t.currentTime))}#S(){const{audioTracks:t}=this.#e;this.#l&&this.#l.audioTrack!==t.selectedIndex&&(this.#l.audioTrack=t.selectedIndex)}onInstance(t){return this.#p.add(t),()=>this.#p.delete(t)}loadSource(t){(0,o.Kg)(t.src)&&this.#l?.loadSource(t.src)}destroy(){this.#l?.destroy(),this.#l=null,this.#u?.(),this.#u=null}}class p{#D;#e;#M;constructor(t,e,i){this.#D=t,this.#e=e,this.#M=i,this.#I()}async#I(){const t={onLoadStart:this.#A.bind(this),onLoaded:this.#_.bind(this),onLoadError:this.#O.bind(this)};let e=await async function(t,e={}){if((0,o.Kg)(t)){e.onLoadStart?.();try{if(await(0,s.k0)(t),!(0,o.Tn)(window.Hls))throw Error("");const i=window.Hls;return e.onLoaded?.(i),i}catch(t){e.onLoadError?.(t)}}}(this.#D,t);if((0,o.b0)(e)&&!(0,o.Kg)(this.#D)&&(e=await async function(t,e={}){if(!(0,o.b0)(t)){if(e.onLoadStart?.(),t.prototype&&t.prototype!==Function)return e.onLoaded?.(t),t;try{const i=(await t())?.default;if(!i||!i.isSupported)throw Error("");return e.onLoaded?.(i),i}catch(t){e.onLoadError?.(t)}}}(this.#D,t)),!e)return null;if(!e.isSupported()){const t="[vidstack] `hls.js` is not supported in this environment";return this.#e.player.dispatch(new o.vP("hls-unsupported")),this.#e.notify("error",{message:t,code:4}),null}return e}#A(){this.#e.player.dispatch(new o.vP("hls-lib-load-start"))}#_(t){this.#e.player.dispatch(new o.vP("hls-lib-loaded",{detail:t})),this.#M(t)}#O(t){const e=(0,l.r)(t);this.#e.player.dispatch(new o.vP("hls-lib-load-error",{detail:e})),this.#e.notify("error",{message:e.message,code:4,error:e})}}class v extends r.VideoProvider{$$PROVIDER_TYPE="HLS";#H=null;#$=new u(this.video,this.ctx);get ctor(){return this.#H}get instance(){return this.#$.instance}static supported=(0,n.m0)();get type(){return"hls"}get canLiveSync(){return!0}#R="https://cdn.jsdelivr.net/npm/hls.js@^1.5.0/dist/hls.min.js";get config(){return this.#$.config}set config(t){this.#$.config=t}get library(){return this.#R}set library(t){this.#R=t}preconnect(){(0,o.Kg)(this.#R)&&(0,s.kZ)(this.#R)}setup(){super.setup(),new p(this.#R,this.ctx,t=>{this.#H=t,this.#$.setup(t),this.ctx.notify("provider-setup",this);const e=(0,o.se)(this.ctx.$state.source);e&&this.loadSource(e)})}async loadSource(t,e){(0,o.Kg)(t.src)?(this.media.preload=e||"",this.appendSource(t,"application/x-mpegurl"),this.#$.loadSource(t),this.currentSrc=t):this.removeSource()}onInstance(t){const e=this.#$.instance;return e&&t(e),this.#$.onInstance(t)}destroy(){this.#$.destroy()}}}}]);